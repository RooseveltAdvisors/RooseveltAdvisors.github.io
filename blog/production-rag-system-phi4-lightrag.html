<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG | Jon Roosevelt</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG | Jon Roosevelt"><meta data-rh="true" name="description" content="After spending months helping enterprises build AI systems, I noticed a pattern: everyone wanted powerful RAG capabilities, but few were comfortable shipping their proprietary data to external APIs. The cost? Predictable. The compliance story? Simple. But the control and security? Gone."><meta data-rh="true" property="og:description" content="After spending months helping enterprises build AI systems, I noticed a pattern: everyone wanted powerful RAG capabilities, but few were comfortable shipping their proprietary data to external APIs. The cost? Predictable. The compliance story? Simple. But the control and security? Gone."><meta data-rh="true" property="og:image" content="https://jonroosevelt.com/img/blog/2025-10-08-production-rag-system-phi4-lightrag/hero-banner.jpg"><meta data-rh="true" name="twitter:image" content="https://jonroosevelt.com/img/blog/2025-10-08-production-rag-system-phi4-lightrag/hero-banner.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-10-08T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://jonroosevelt.com"><meta data-rh="true" property="article:tag" content="AI,LLM,RAG,Healthcare,Cloud,Architecture,Data"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag"><link data-rh="true" rel="alternate" href="https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag" hreflang="en"><link data-rh="true" rel="alternate" href="https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag","mainEntityOfPage":"https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag","url":"https://jonroosevelt.com/blog/production-rag-system-phi4-lightrag","headline":"Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG","name":"Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG","description":"After spending months helping enterprises build AI systems, I noticed a pattern: everyone wanted powerful RAG capabilities, but few were comfortable shipping their proprietary data to external APIs. The cost? Predictable. The compliance story? Simple. But the control and security? Gone.","datePublished":"2025-10-08T00:00:00.000Z","author":{"@type":"Person","name":"Jon Roosevelt","description":"Consultant","url":"https://jonroosevelt.com","image":"https://github.com/RooseveltAdvisors.png"},"image":{"@type":"ImageObject","@id":"https://jonroosevelt.com/img/blog/2025-10-08-production-rag-system-phi4-lightrag/hero-banner.jpg","url":"https://jonroosevelt.com/img/blog/2025-10-08-production-rag-system-phi4-lightrag/hero-banner.jpg","contentUrl":"https://jonroosevelt.com/img/blog/2025-10-08-production-rag-system-phi4-lightrag/hero-banner.jpg","caption":"title image for the blog post: Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://jonroosevelt.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jon Roosevelt RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jon Roosevelt Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TECW05ZKH4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TECW05ZKH4",{anonymize_ip:!0})</script>






<script src="https://cloud.umami.is/script.js" data-website-id="c31542ec-5010-4c26-9acb-391b1c521728" data-domains="jonroosevelt.com,rooseveltadvisors.github.io" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.e4cadd58.css">
<script src="/assets/js/runtime~main.a3698d86.js" defer="defer"></script>
<script src="/assets/js/main.e836558c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://github.com/RooseveltAdvisors.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Jon Roosevelt</b></a><a href="https://cloud.umami.is/share/nl5j9KUNu01VtqfG/jonroosevelt.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Analytics</a><a class="navbar__item navbar__link" href="/showcase">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/jonroosevelt/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="Linkedin profile"></a><a href="https://github.com/RooseveltAdvisors" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2026/01/25/ai-second-brain">How AI Transformed My Second Brain from Passive to Active</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/burden-of-being">The Burden of Being: Why Responsibility Might Be the Antidote to Modern Nihilism</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ai-urgent-care-trends">Two AI Trends Transforming Urgent Care in 2026</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/four-line-architecture-beat-complex-ai-frameworks">The 4-Line Architecture That Beat Complex AI Frameworks</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ai-patient-chatbot-urgent-care">Building an AI Patient Chatbot for Urgent Care with n8n, GPT-4, and Langfuse</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Building an Enterprise RAG System with Local SLMs: My Journey with Phi-4 and LightRAG</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-10-08T00:00:00.000Z">October 8, 2025</time> · <!-- -->23 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/all-jon-roosevelt-articles"><img class="avatar__photo authorImage_XqGP" src="https://github.com/RooseveltAdvisors.png" alt="Jon Roosevelt"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/all-jon-roosevelt-articles"><span class="authorName_yefp">Jon Roosevelt</span></a></div><small class="authorTitle_nd0D" title="Consultant">Consultant</small><div class="authorSocials_rSDt"><a href="https://www.linkedin.com/in/jonroosevelt/" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 256" class="authorSocialLink_owbf"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453" fill="#0A66C2"></path></svg></a><a href="https://github.com/RooseveltAdvisors" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>After spending months helping enterprises build AI systems, I noticed a pattern: everyone wanted powerful RAG capabilities, but few were comfortable shipping their proprietary data to external APIs. The cost? Predictable. The compliance story? Simple. But the control and security? Gone.</p>
<p>So I asked myself: could we build something that matches GraphRAG and Nano-GraphRAG performance using entirely local, self-hosted components?</p>
<p>The answer surprised me. Not only is it possible—it&#x27;s practical, cost-effective, and production-ready. Here&#x27;s what I learned building a complete Graph RAG system with Phi-4 and LightRAG.</p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-local-slms--graph-rag-matter-now">Why Local SLMs + Graph RAG Matter Now<a href="#why-local-slms--graph-rag-matter-now" class="hash-link" aria-label="Direct link to Why Local SLMs + Graph RAG Matter Now" title="Direct link to Why Local SLMs + Graph RAG Matter Now">​</a></h2>
<p>Let me cut straight to what matters: cost, control, and compliance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-real-cost-story">The Real Cost Story<a href="#the-real-cost-story" class="hash-link" aria-label="Direct link to The Real Cost Story" title="Direct link to The Real Cost Story">​</a></h3>
<p>I ran the numbers for a typical enterprise knowledge base—about 50,000 documents, 1,000 queries per day. Here&#x27;s what I found:</p>
<p><strong>OpenAI API approach:</strong></p>
<ul>
<li>GPT-4 for entity extraction: ~$1,500/month</li>
<li>GPT-4 for query responses: ~$800/month</li>
<li>Embedding API: ~$200/month</li>
<li>Vector database (Pinecone): ~$300/month</li>
<li>Graph database (Neo4j Aura): ~$500/month</li>
<li><strong>Total: $3,300/month or $39,600/year</strong></li>
</ul>
<p><strong>Self-hosted with Phi-4:</strong></p>
<ul>
<li>All infrastructure on AWS: ~$2,220/month or $26,640/year</li>
<li><strong>Annual savings: $12,960 (33% reduction)</strong></li>
</ul>
<p>Or go fully on-premise with a GPU server (~$6,000 upfront) and you&#x27;re looking at $2,300/year in operating costs. Break-even in 2.3 months.</p>
<p>But cost isn&#x27;t the whole story.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-sovereignty-changes-everything">Data Sovereignty Changes Everything<a href="#data-sovereignty-changes-everything" class="hash-link" aria-label="Direct link to Data Sovereignty Changes Everything" title="Direct link to Data Sovereignty Changes Everything">​</a></h3>
<p>If you&#x27;re in healthcare, finance, or any regulated industry, you know the drill. Every vendor that touches your data needs:</p>
<ul>
<li>Business Associate Agreements (HIPAA)</li>
<li>Data Processing Agreements (GDPR)</li>
<li>SOC 2 audits</li>
<li>Regular security reviews</li>
<li>Incident response coordination</li>
</ul>
<p>With a self-hosted system? Your data never leaves your infrastructure. The compliance story becomes: &quot;We don&#x27;t send data anywhere.&quot; Done.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-at-your-pace">Performance at Your Pace<a href="#performance-at-your-pace" class="hash-link" aria-label="Direct link to Performance at Your Pace" title="Direct link to Performance at Your Pace">​</a></h3>
<p>No rate limits. No surprise throttling during usage spikes. No waiting on API quota increases.</p>
<p>You control the throughput. You optimize for your workload. You scale when ready.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-deep-dive">Architecture Deep Dive<a href="#architecture-deep-dive" class="hash-link" aria-label="Direct link to Architecture Deep Dive" title="Direct link to Architecture Deep Dive">​</a></h2>
<p>Let me show you what we&#x27;re building:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-four-storage-systems">Why Four Storage Systems?<a href="#why-four-storage-systems" class="hash-link" aria-label="Direct link to Why Four Storage Systems?" title="Direct link to Why Four Storage Systems?">​</a></h3>
<p>When I first looked at LightRAG, I thought &quot;surely we don&#x27;t need ALL of these.&quot; I tried running it with just PostgreSQL. Failed. Tried with just Neo4j. Failed.</p>
<p>Turns out, each storage system has a specific job:</p>
<p><strong>PostgreSQL with pgvector</strong> handles three critical tasks:</p>
<ul>
<li>Vector embeddings for similarity search</li>
<li>Key-value storage for document metadata</li>
<li>Document processing status tracking</li>
</ul>
<p><strong>Neo4j</strong> stores the knowledge graph—the relationships between entities that make Graph RAG powerful. This is where the magic happens: multi-hop reasoning, entity deduplication, and relationship inference.</p>
<p><strong>Redis</strong> caches LLM responses. When Phi-4 takes 2-3 seconds to extract entities from a document, you don&#x27;t want to do it twice. Redis cut my processing time by 60% on repeated operations.</p>
<p><strong>Phi-4 via Ollama</strong> is your local LLM. 14 billion parameters, 128K context window (if you configure it right—more on that later), and it runs entirely on your hardware.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lightrag-the-secret-sauce">LightRAG: The Secret Sauce<a href="#lightrag-the-secret-sauce" class="hash-link" aria-label="Direct link to LightRAG: The Secret Sauce" title="Direct link to LightRAG: The Secret Sauce">​</a></h3>
<p>LightRAG isn&#x27;t just another RAG framework. It&#x27;s specifically designed for graph-based RAG with:</p>
<ul>
<li>
<p><strong>Multi-hop reasoning</strong>: &quot;What technologies does our healthcare platform use and what security measures protect patient data?&quot; requires jumping across multiple entity relationships.</p>
</li>
<li>
<p><strong>Entity deduplication</strong>: &quot;AWS Lambda,&quot; &quot;Lambda functions,&quot; and &quot;λ&quot; all refer to the same thing. LightRAG figures this out.</p>
</li>
<li>
<p><strong>Hybrid query modes</strong>: Choose between local search (specific entities), global search (broad patterns), or mix both for comprehensive answers.</p>
</li>
<li>
<p><strong>Document status tracking</strong>: Production systems fail. Documents get corrupted. APIs time out. LightRAG tracks every document&#x27;s processing state with built-in retry capability.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="two-deployment-paths">Two Deployment Paths<a href="#two-deployment-paths" class="hash-link" aria-label="Direct link to Two Deployment Paths" title="Direct link to Two Deployment Paths">​</a></h2>
<p>I&#x27;ve deployed this system both ways. Here&#x27;s what you need to know about each.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-1-local-linux-machine-budget-friendly">Path 1: Local Linux Machine (Budget-Friendly)<a href="#path-1-local-linux-machine-budget-friendly" class="hash-link" aria-label="Direct link to Path 1: Local Linux Machine (Budget-Friendly)" title="Direct link to Path 1: Local Linux Machine (Budget-Friendly)">​</a></h3>
<p>This is my development setup. One beefy Linux box in the corner of my office.</p>
<p><strong>Hardware requirements:</strong></p>
<p><em>Minimum viable (you can actually run this):</em></p>
<ul>
<li>CPU: 16 cores</li>
<li>RAM: 64GB</li>
<li>GPU: RTX 4090 (24GB VRAM)</li>
<li>Storage: 500GB NVMe SSD</li>
<li>Cost: ~$3,000-4,000</li>
</ul>
<p><em>Recommended (smooth experience):</em></p>
<ul>
<li>CPU: 24-32 cores</li>
<li>RAM: 128GB</li>
<li>GPU: A6000 (48GB VRAM) or dual RTX 4090</li>
<li>Storage: 1TB NVMe SSD</li>
<li>Cost: ~$6,000-8,000</li>
</ul>
<p><strong>Monthly operating cost:</strong> $50-150 (mostly electricity)</p>
<p>The beauty? After that initial hardware investment, you&#x27;re essentially running free. No per-token charges. No usage-based billing surprises.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-2-aws-cloud-native-architecture">Path 2: AWS Cloud-Native Architecture<a href="#path-2-aws-cloud-native-architecture" class="hash-link" aria-label="Direct link to Path 2: AWS Cloud-Native Architecture" title="Direct link to Path 2: AWS Cloud-Native Architecture">​</a></h3>
<p>For production deployments, I recommend AWS. Here&#x27;s the architecture:</p>
<!-- -->
<p>Here&#x27;s the service mapping:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Component          Local                  AWS Service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">─────────────────  ───────────────────    ─────────────────────────</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PostgreSQL         Docker Container        RDS for PostgreSQL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Neo4j              Docker Container        EC2 + EBS (Neo4j)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Redis              Docker Container        ElastiCache for Redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Phi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4 LLM          Ollama on GPU          EC2 G5 instance</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LightRAG App       Docker Container        ECS Fargate / EC2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Storage            Local disk             EFS / S3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Why these specific choices?</strong></p>
<p><strong>RDS for PostgreSQL</strong> gives you managed backups, automated patching, and Multi-AZ high availability. Yes, it costs more than self-managed (~$280-560/month vs ~$100-200/month), but the operational overhead savings are worth it.</p>
<p><strong>Neo4j on EC2</strong> because there&#x27;s no managed Neo4j on AWS yet. I use r6i.2xlarge (8 vCPU, 64GB RAM, ~$400/month) with gp3 EBS volumes. Reserved instances cut this to ~$300/month.</p>
<p><strong>ElastiCache for Redis</strong> (~$150-280/month) handles failover automatically. Better than self-managed for production.</p>
<p><strong>EC2 G5 for Phi-4</strong> is the interesting one. g5.2xlarge gives you 24GB GPU, enough for Phi-4. At $1.20/hour, that&#x27;s <del>$900/month for 24/7 operation. But here&#x27;s the trick: use Spot Instances during development for 60-70% savings. Run it only during business hours in dev environments (</del>$200-400/month).</p>
<p><strong>AWS Cost Reality Check:</strong></p>
<p>Development/testing: ~$870/month</p>
<ul>
<li>RDS PostgreSQL: $280</li>
<li>EC2 Neo4j: $200</li>
<li>ElastiCache Redis: $150</li>
<li>EC2 G5 (Spot, 8h/day): $100</li>
<li>ECS Fargate: $60</li>
<li>Storage: $50</li>
<li>Data Transfer: $30</li>
</ul>
<p>Production 24/7: ~$2,220/month</p>
<ul>
<li>RDS PostgreSQL Multi-AZ: $560</li>
<li>EC2 Neo4j Reserved: $300</li>
<li>ElastiCache Redis HA: $280</li>
<li>EC2 G5 Reserved: $650</li>
<li>ECS Fargate HA: $180</li>
<li>Infrastructure: $250</li>
</ul>
<p>Still 33% cheaper than the OpenAI API approach.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-i-learned-the-hard-way">What I Learned (The Hard Way)<a href="#what-i-learned-the-hard-way" class="hash-link" aria-label="Direct link to What I Learned (The Hard Way)" title="Direct link to What I Learned (The Hard Way)">​</a></h2>
<p>Let me save you some pain.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-1-git-history-and-upstream-syncing">Lesson 1: Git History and Upstream Syncing<a href="#lesson-1-git-history-and-upstream-syncing" class="hash-link" aria-label="Direct link to Lesson 1: Git History and Upstream Syncing" title="Direct link to Lesson 1: Git History and Upstream Syncing">​</a></h3>
<p>I forked the LightRAG repository to customize my docker-compose setup. Everything worked great until I wanted to pull upstream updates.</p>
<p><code>git merge upstream/main</code> failed spectacularly: &quot;refusing to merge unrelated histories.&quot;</p>
<p>The problem? I&#x27;d made too many custom changes. The solution wasn&#x27;t pretty:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Always backup before destructive operations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git branch backup-main-$(date +%Y%m%d)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Hard reset to upstream (scary but necessary)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git reset --hard upstream/main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Cherry-pick your custom configs back</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git checkout backup-branch -- docker-compose.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git checkout backup-branch -- .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Lesson learned:</strong> Keep your customizations in separate override files. LightRAG supports <code>docker-compose.override.yml</code> for exactly this reason.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-2-docker-service-dependencies-matter">Lesson 2: Docker Service Dependencies Matter<a href="#lesson-2-docker-service-dependencies-matter" class="hash-link" aria-label="Direct link to Lesson 2: Docker Service Dependencies Matter" title="Direct link to Lesson 2: Docker Service Dependencies Matter">​</a></h3>
<p>My first deployment kept failing with cryptic DNS resolution errors. The LightRAG container would start, try to connect to PostgreSQL, and fail—even though PostgreSQL was &quot;running.&quot;</p>
<p>The issue? Service start order. PostgreSQL takes 10-15 seconds to actually become ready. LightRAG was trying to connect after 2 seconds.</p>
<p>The fix:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">lightrag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> service_healthy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">neo4j</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> service_healthy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> service_healthy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">healthcheck</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CMD-SHELL&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pg_isready -U postgres&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">interval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 5s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 5s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">retries</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now services wait for actual health, not just &quot;started.&quot;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-3-phi-4-context-window-configuration">Lesson 3: Phi-4 Context Window Configuration<a href="#lesson-3-phi-4-context-window-configuration" class="hash-link" aria-label="Direct link to Lesson 3: Phi-4 Context Window Configuration" title="Direct link to Lesson 3: Phi-4 Context Window Configuration">​</a></h3>
<p>This one cost me hours of debugging.</p>
<p>LightRAG needs at least 32K context window to work properly. Default Ollama models? 8K context.</p>
<p>I kept getting errors like &quot;context length exceeded&quot; during entity extraction. The documents weren&#x27;t even that long—maybe 5,000 words.</p>
<p>The problem? Phi-4&#x27;s system prompt, the document text, AND the structured output schema all fit in that context window. 8K wasn&#x27;t enough.</p>
<p>The fix:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Create a custom Modelfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama show --modelfile phi4 &gt; Modelfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Add this line</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo &quot;PARAMETER num_ctx 32768&quot; &gt;&gt; Modelfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Create new model with larger context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama create -f Modelfile phi4-32k</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or set it via the API:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">llm_model_kwargs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;options&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;num_ctx&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">32768</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Critical:</strong> If you&#x27;re running LightRAG and seeing entity extraction failures, check your context window first.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-4-document-processing-needs-robust-retry-logic">Lesson 4: Document Processing Needs Robust Retry Logic<a href="#lesson-4-document-processing-needs-robust-retry-logic" class="hash-link" aria-label="Direct link to Lesson 4: Document Processing Needs Robust Retry Logic" title="Direct link to Lesson 4: Document Processing Needs Robust Retry Logic">​</a></h3>
<p>Production systems fail. API calls timeout. LLMs hallucinate invalid JSON. Documents get corrupted during upload.</p>
<p>I discovered LightRAG has a &quot;Retry Failed Documents&quot; button in the Web UI (in <code>lightrag_webui/src/features/DocumentManager.tsx</code>). It implements smart polling:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Fast polling during active retry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">startPollingInterval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// After 15 seconds, switch to adaptive polling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">setTimeout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> normalInterval </span><span class="token operator">=</span><span class="token plain"> hasActiveDocuments </span><span class="token operator">?</span><span class="token plain"> </span><span class="token number">5000</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">30000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">startPollingInterval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">normalInterval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">15000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This pattern—fast polling during active work, slow polling otherwise—is brilliant for managing client-side resource usage while maintaining responsiveness.</p>
<p>I adopted the same pattern for monitoring batch document uploads.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-5-memory-tuning-is-non-negotiable">Lesson 5: Memory Tuning Is Non-Negotiable<a href="#lesson-5-memory-tuning-is-non-negotiable" class="hash-link" aria-label="Direct link to Lesson 5: Memory Tuning Is Non-Negotiable" title="Direct link to Lesson 5: Memory Tuning Is Non-Negotiable">​</a></h3>
<p>Out-of-the-box configurations are sized for development, not production.</p>
<p>After indexing about 10,000 documents, my query performance degraded from 2 seconds to 15+ seconds. The culprit? Default memory settings.</p>
<p><strong>PostgreSQL tuning:</strong></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">-- Assuming 64GB system RAM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shared_buffers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain">GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">effective_cache_size </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">24</span><span class="token plain">GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">maintenance_work_mem </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">work_mem </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">256</span><span class="token plain">MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Neo4j tuning:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dbms.memory.heap.max_size = 16G</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dbms.memory.pagecache.size = 20G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Result? Query performance improved 3-5x. Worth the 30 minutes to configure properly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-30-minute-quick-start">Getting Started: 30-Minute Quick Start<a href="#getting-started-30-minute-quick-start" class="hash-link" aria-label="Direct link to Getting Started: 30-Minute Quick Start" title="Direct link to Getting Started: 30-Minute Quick Start">​</a></h2>
<p>Let me walk you through the setup. This assumes you have Docker, Docker Compose, and either a GPU with 24GB+ VRAM or patience for CPU inference.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prerequisites-check">Step 1: Prerequisites Check<a href="#step-1-prerequisites-check" class="hash-link" aria-label="Direct link to Step 1: Prerequisites Check" title="Direct link to Step 1: Prerequisites Check">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Docker and Docker Compose</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker --version  # Should be 20.10+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose version  # Should be 2.0+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># GPU check (if using GPU)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nvidia-smi  # Should show your GPU</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Disk space</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">df -h  # Need 500GB+ free</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-clone-and-configure">Step 2: Clone and Configure<a href="#step-2-clone-and-configure" class="hash-link" aria-label="Direct link to Step 2: Clone and Configure" title="Direct link to Step 2: Clone and Configure">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git clone https://github.com/HKUDS/LightRAG.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd LightRAG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cp env.example .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-set-up-phi-4-with-ollama">Step 3: Set Up Phi-4 with Ollama<a href="#step-3-set-up-phi-4-with-ollama" class="hash-link" aria-label="Direct link to Step 3: Set Up Phi-4 with Ollama" title="Direct link to Step 3: Set Up Phi-4 with Ollama">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Install Ollama</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -fsSL https://ollama.com/install.sh | sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Pull Phi-4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama pull phi4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Configure for 32K context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama show --modelfile phi4 &gt; Modelfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo &quot;PARAMETER num_ctx 32768&quot; &gt;&gt; Modelfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama create -f Modelfile phi4-32k</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Verify</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ollama run phi4-32k &quot;Test message&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-configure-environment-variables">Step 4: Configure Environment Variables<a href="#step-4-configure-environment-variables" class="hash-link" aria-label="Direct link to Step 4: Configure Environment Variables" title="Direct link to Step 4: Configure Environment Variables">​</a></h3>
<p>Edit your <code>.env</code> file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># LLM Configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LLM_BINDING=ollama</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LLM_MODEL=phi4-32k</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EMBEDDING_MODEL=nomic-embed-text</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EMBEDDING_DIM=768</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Database Configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">POSTGRES_PASSWORD=your_secure_password_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NEO4J_PASSWORD=your_secure_password_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REDIS_PASSWORD=your_secure_password_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Optional: API authentication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LIGHTRAG_API_KEY=your_api_key_here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Security note:</strong> Change those passwords. Seriously. I&#x27;ve seen production systems compromised because someone left the default &quot;password123.&quot;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-launch-the-stack">Step 5: Launch the Stack<a href="#step-5-launch-the-stack" class="hash-link" aria-label="Direct link to Step 5: Launch the Stack" title="Direct link to Step 5: Launch the Stack">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Start all services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose up -d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Watch the logs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose logs -f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Wait for all services to be healthy (2-3 minutes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose ps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see all services with status &quot;Up (healthy)&quot;.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-verify-deployment">Step 6: Verify Deployment<a href="#step-6-verify-deployment" class="hash-link" aria-label="Direct link to Step 6: Verify Deployment" title="Direct link to Step 6: Verify Deployment">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Check LightRAG API health</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl http://localhost:9621/health</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Should return: {&quot;status&quot;: &quot;healthy&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Access Web UI</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open http://localhost:9621/webui/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you see the Web UI, you&#x27;re ready to start indexing documents.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-use-case-indexing-technical-documentation">Real-World Use Case: Indexing Technical Documentation<a href="#real-world-use-case-indexing-technical-documentation" class="hash-link" aria-label="Direct link to Real-World Use Case: Indexing Technical Documentation" title="Direct link to Real-World Use Case: Indexing Technical Documentation">​</a></h2>
<p>Let me show you a practical example. I recently indexed my company&#x27;s entire technical documentation—about 500 Markdown files covering architecture, APIs, deployment guides, and runbooks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prepare-your-documents">Step 1: Prepare Your Documents<a href="#step-1-prepare-your-documents" class="hash-link" aria-label="Direct link to Step 1: Prepare Your Documents" title="Direct link to Step 1: Prepare Your Documents">​</a></h3>
<p>Export your documentation as plain text, Markdown, or PDF. Place files in an <code>inputs</code> directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mkdir inputs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Copy your docs here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-bulk-insert-via-api">Step 2: Bulk Insert via API<a href="#step-2-bulk-insert-via-api" class="hash-link" aria-label="Direct link to Step 2: Bulk Insert via API" title="Direct link to Step 2: Bulk Insert via API">​</a></h3>
<p>Here&#x27;s a Python script I use for batch uploads:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pathlib </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LIGHTRAG_URL </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://localhost:9621&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">API_KEY </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;your-api-key&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># If authentication enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">headers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Authorization&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Bearer </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">API_KEY</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;application/json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">index_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">input_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;Index all text files in a directory&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    documents </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> file_path </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> Path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">input_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rglob</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.md&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;r&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> encoding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;utf-8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            content </span><span class="token operator">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;content&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file_path&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;metadata&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;source&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;technical_docs&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;category&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Batch insert (chunk if &gt;100 documents)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    batch_size </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">50</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        batch </span><span class="token operator">=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">i </span><span class="token operator">+</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">LIGHTRAG_URL</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">/api/documents/insert&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            json</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;documents&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">status_code </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">200</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Inserted batch </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator">//</span><span class="token string-interpolation interpolation">batch_size </span><span class="token string-interpolation interpolation operator">+</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number">1</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(189, 147, 249)">len</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation interpolation">batch</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)"> documents&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Error: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">status_code</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)"> - </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">text</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> __name__ </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;__main__&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    index_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./inputs&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-monitor-processing">Step 3: Monitor Processing<a href="#step-3-monitor-processing" class="hash-link" aria-label="Direct link to Step 3: Monitor Processing" title="Direct link to Step 3: Monitor Processing">​</a></h3>
<p>Open the Web UI at <code>http://localhost:9621/webui/</code> and navigate to the Documents tab.</p>
<p>You&#x27;ll see each document&#x27;s processing status:</p>
<ul>
<li><strong>Pending</strong>: Queued for processing</li>
<li><strong>Processing</strong>: Currently extracting entities and relationships</li>
<li><strong>Completed</strong>: Successfully indexed</li>
<li><strong>Failed</strong>: Error occurred (check logs)</li>
</ul>
<p>For failed documents, click &quot;Retry Failed Documents&quot; to reprocess them.</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-query-your-knowledge-base">Step 4: Query Your Knowledge Base<a href="#step-4-query-your-knowledge-base" class="hash-link" aria-label="Direct link to Step 4: Query Your Knowledge Base" title="Direct link to Step 4: Query Your Knowledge Base">​</a></h3>
<p>Now for the fun part—querying:</p>
<!-- -->
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">query_knowledge_base</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hybrid&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    Query modes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    - local: Entity-focused, specific questions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    - global: High-level summaries, broad patterns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    - hybrid: Combines both approaches</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    - naive: Traditional RAG (baseline comparison)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    - mix: Weighted combination of local and global</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">LIGHTRAG_URL</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">/api/query&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        json</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mode&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;top_k&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">40</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Number of relevant chunks to retrieve</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;\n**Question:** </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">query</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;\n**Answer:**\n</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">result</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation interpolation string" style="color:rgb(255, 121, 198)">&#x27;answer&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;\n**Sources:** </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(189, 147, 249)">len</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation interpolation">result</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation interpolation string" style="color:rgb(255, 121, 198)">&#x27;sources&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)"> documents&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Example queries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query_knowledge_base</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;What is our microservices deployment strategy?&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mode</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hybrid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query_knowledge_base</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;How do we handle authentication across services?&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mode</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;local&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query_knowledge_base</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Summarize our cloud infrastructure architecture&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mode</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;global&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="results-in-my-testing">Results in My Testing<a href="#results-in-my-testing" class="hash-link" aria-label="Direct link to Results in My Testing" title="Direct link to Results in My Testing">​</a></h3>
<p>On my 500-document technical documentation corpus:</p>
<ul>
<li><strong>Indexing time:</strong> ~45 minutes (with Phi-4 on RTX 4090)</li>
<li><strong>Query latency:</strong> 2-4 seconds for hybrid queries</li>
<li><strong>Answer quality:</strong> Consistently better than naive RAG, on par with GPT-4 + GraphRAG</li>
<li><strong>Cost:</strong> Zero per query (after infrastructure investment)</li>
</ul>
<p>The &quot;hybrid&quot; mode performed best for most questions, combining specific entity lookups with broader pattern recognition.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="production-considerations">Production Considerations<a href="#production-considerations" class="hash-link" aria-label="Direct link to Production Considerations" title="Direct link to Production Considerations">​</a></h2>
<p>Taking this from prototype to production requires thinking about security, monitoring, and reliability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-hardening">Security Hardening<a href="#security-hardening" class="hash-link" aria-label="Direct link to Security Hardening" title="Direct link to Security Hardening">​</a></h3>
<p><strong>Network isolation is critical:</strong></p>
<ol>
<li>
<p><strong>VPC architecture</strong> (if on AWS):</p>
<ul>
<li>Private subnets for databases (no internet access)</li>
<li>Application subnet behind ALB</li>
<li>VPN or bastion host for admin access</li>
<li>Security groups limiting port access by source</li>
</ul>
</li>
<li>
<p><strong>Secret management:</strong></p>
<ul>
<li>Use AWS Secrets Manager or HashiCorp Vault</li>
<li>Rotate database passwords quarterly</li>
<li>Never commit <code>.env</code> files to git (add to <code>.gitignore</code>)</li>
<li>Use IAM roles instead of access keys where possible</li>
</ul>
</li>
<li>
<p><strong>API authentication:</strong></p>
<ul>
<li>Enable <code>LIGHTRAG_API_KEY</code> for production</li>
<li>Implement JWT tokens for user authentication</li>
<li>Add rate limiting (I recommend 100 requests/minute per user)</li>
<li>Log all API access for audit trails</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-and-observability">Monitoring and Observability<a href="#monitoring-and-observability" class="hash-link" aria-label="Direct link to Monitoring and Observability" title="Direct link to Monitoring and Observability">​</a></h3>
<p>You can&#x27;t fix what you can&#x27;t see. Here&#x27;s what I monitor:</p>
<p><strong>Application metrics:</strong></p>
<ul>
<li>Document processing throughput (documents/hour)</li>
<li>Query latency (p50, p95, p99 percentiles)</li>
<li>Error rates by operation type</li>
<li>LLM token usage (context window utilization)</li>
</ul>
<p><strong>Infrastructure metrics:</strong></p>
<ul>
<li>Database query performance (slow query logs)</li>
<li>Knowledge graph size (nodes/edges over time)</li>
<li>Disk space (especially for Neo4j graph data)</li>
<li>GPU utilization and memory (if using GPU inference)</li>
</ul>
<p><strong>Recommended tools:</strong></p>
<ul>
<li>Prometheus + Grafana for metrics visualization</li>
<li>ELK stack (Elasticsearch, Logstash, Kibana) for log aggregation</li>
<li>CloudWatch if on AWS (integrated with RDS, ECS, etc.)</li>
</ul>
<p><strong>Alerting rules I use:</strong></p>
<ul>
<li>Failed document processing count &gt; 10 in 1 hour</li>
<li>Query latency p95 &gt; 10 seconds</li>
<li>Database connection pool exhaustion</li>
<li>Disk space &lt; 20% remaining</li>
<li>GPU out-of-memory errors</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backup-and-disaster-recovery">Backup and Disaster Recovery<a href="#backup-and-disaster-recovery" class="hash-link" aria-label="Direct link to Backup and Disaster Recovery" title="Direct link to Backup and Disaster Recovery">​</a></h3>
<p>Data loss in a knowledge base is catastrophic. Your entire organization&#x27;s institutional knowledge, gone.</p>
<p><strong>My backup strategy:</strong></p>
<p><strong>PostgreSQL:</strong></p>
<ul>
<li>Automated daily snapshots (RDS handles this automatically)</li>
<li>Point-in-time recovery enabled (up to 7 days)</li>
<li>Monthly backups exported to S3 for long-term retention</li>
</ul>
<p><strong>Neo4j:</strong></p>
<ul>
<li>Weekly full backups using <code>neo4j-admin backup</code></li>
<li>Daily incremental backups</li>
<li>Store backups in separate S3 bucket with versioning</li>
</ul>
<p><strong>Redis:</strong></p>
<ul>
<li>AOF (Append-Only File) persistence enabled</li>
<li>RDB snapshots every 6 hours</li>
<li>Redis data is cache—can be rebuilt from PostgreSQL if lost</li>
</ul>
<p><strong>S3 document storage:</strong></p>
<ul>
<li>Versioning enabled (recover accidentally deleted files)</li>
<li>Cross-region replication for disaster recovery</li>
<li>Lifecycle policies to archive old versions to Glacier</li>
</ul>
<p><strong>Recovery objectives:</strong></p>
<ul>
<li>RTO (Recovery Time Objective): &lt; 4 hours</li>
<li>RPO (Recovery Point Objective): &lt; 24 hours</li>
</ul>
<p>Test your recovery process quarterly. I learned this the hard way when a junior engineer accidentally dropped a Neo4j database. Took us 6 hours to restore because we&#x27;d never practiced the procedure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaling-strategies">Scaling Strategies<a href="#scaling-strategies" class="hash-link" aria-label="Direct link to Scaling Strategies" title="Direct link to Scaling Strategies">​</a></h3>
<p>Start small, scale based on actual usage metrics.</p>
<!-- -->
<p><strong>Vertical scaling (do this first):</strong></p>
<ul>
<li>Increase PostgreSQL instance size (more RAM = better vector search performance)</li>
<li>Add more RAM to Neo4j (graph traversal is memory-intensive)</li>
<li>Upgrade to larger GPU for Phi-4 (faster inference)</li>
</ul>
<p><strong>Horizontal scaling (when vertical hits limits):</strong></p>
<ul>
<li>PostgreSQL read replicas for query traffic</li>
<li>Neo4j Causal Cluster for high availability (Enterprise Edition required)</li>
<li>Multiple LightRAG application instances behind ALB</li>
<li>Consider dedicated Phi-4 inference endpoints per workload</li>
</ul>
<p><strong>Performance optimization tricks:</strong></p>
<ul>
<li>Enable aggressive query result caching in Redis</li>
<li>Use pgvector HNSW indexing (better than IVFFlat for most cases)</li>
<li>Batch document processing during off-peak hours</li>
<li>Implement connection pooling (PgBouncer for PostgreSQL)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="roi-and-business-case">ROI and Business Case<a href="#roi-and-business-case" class="hash-link" aria-label="Direct link to ROI and Business Case" title="Direct link to ROI and Business Case">​</a></h2>
<p>Let me break down the economics for your CFO.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-month-cost-comparison">12-Month Cost Comparison<a href="#12-month-cost-comparison" class="hash-link" aria-label="Direct link to 12-Month Cost Comparison" title="Direct link to 12-Month Cost Comparison">​</a></h3>
<p><strong>OpenAI API Approach (baseline):</strong></p>
<table><thead><tr><th>Component</th><th>Monthly</th><th>Annual</th></tr></thead><tbody><tr><td>GPT-4 API (entity extraction)</td><td>$1,500</td><td>$18,000</td></tr><tr><td>GPT-4 API (query responses)</td><td>$800</td><td>$9,600</td></tr><tr><td>Embedding API</td><td>$200</td><td>$2,400</td></tr><tr><td>Vector database (Pinecone)</td><td>$300</td><td>$3,600</td></tr><tr><td>Graph database (Neo4j Aura)</td><td>$500</td><td>$6,000</td></tr><tr><td><strong>TOTAL</strong></td><td><strong>$3,300</strong></td><td><strong>$39,600</strong></td></tr></tbody></table>
<p><strong>Self-Hosted on AWS:</strong></p>
<table><thead><tr><th>Component</th><th>Monthly</th><th>Annual</th></tr></thead><tbody><tr><td>RDS PostgreSQL</td><td>$560</td><td>$6,720</td></tr><tr><td>EC2 Neo4j (Reserved)</td><td>$300</td><td>$3,600</td></tr><tr><td>ElastiCache Redis</td><td>$280</td><td>$3,360</td></tr><tr><td>EC2 G5 Phi-4 (Reserved)</td><td>$650</td><td>$7,800</td></tr><tr><td>ECS Fargate LightRAG</td><td>$180</td><td>$2,160</td></tr><tr><td>Infrastructure (ALB, S3, etc)</td><td>$250</td><td>$3,000</td></tr><tr><td><strong>TOTAL</strong></td><td><strong>$2,220</strong></td><td><strong>$26,640</strong></td></tr></tbody></table>
<p><strong>Annual savings: $12,960 (33% reduction)</strong></p>
<p><strong>Self-Hosted On-Premise:</strong></p>
<table><thead><tr><th>Component</th><th>Initial</th><th>Annual Operating</th></tr></thead><tbody><tr><td>Hardware (GPU server)</td><td>$6,000</td><td>-</td></tr><tr><td>Electricity (24/7)</td><td>-</td><td>$1,200</td></tr><tr><td>Internet/Bandwidth</td><td>-</td><td>$600</td></tr><tr><td>Maintenance/Upgrades</td><td>-</td><td>$500</td></tr><tr><td><strong>TOTAL</strong></td><td><strong>$6,000 upfront</strong></td><td><strong>$2,300/year</strong></td></tr></tbody></table>
<p><strong>Break-even vs OpenAI: 2.3 months</strong>
<strong>3-year TCO: $12,900 (67% savings vs OpenAI)</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="beyond-cost-strategic-value">Beyond Cost: Strategic Value<a href="#beyond-cost-strategic-value" class="hash-link" aria-label="Direct link to Beyond Cost: Strategic Value" title="Direct link to Beyond Cost: Strategic Value">​</a></h3>
<p>The spreadsheet tells part of the story. Here&#x27;s the rest:</p>
<p><strong>Data sovereignty:</strong> Your proprietary knowledge base never touches third-party APIs. For healthcare, finance, or legal firms, this eliminates entire categories of compliance concerns.</p>
<p><strong>Predictable scaling:</strong> No surprise bills when usage spikes. Your infrastructure costs are fixed—scale at your own pace.</p>
<p><strong>Customization freedom:</strong> Fine-tune Phi-4 on your domain-specific data. Optimize prompt templates for your use cases. Implement custom entity extraction logic. Good luck doing that with a closed API.</p>
<p><strong>Performance guarantees:</strong> No rate limits. No throttling. No waiting on quota increases. You control throughput and optimize for your specific workload.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-should-you-choose-this-approach">When Should You Choose This Approach?<a href="#when-should-you-choose-this-approach" class="hash-link" aria-label="Direct link to When Should You Choose This Approach?" title="Direct link to When Should You Choose This Approach?">​</a></h2>
<p>Not every organization needs self-hosted RAG. Here&#x27;s my decision framework:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-choose-local--lightrag-if-you">✅ Choose Local + LightRAG if you:<a href="#-choose-local--lightrag-if-you" class="hash-link" aria-label="Direct link to ✅ Choose Local + LightRAG if you:" title="Direct link to ✅ Choose Local + LightRAG if you:">​</a></h3>
<ul>
<li><strong>Have proprietary/sensitive data</strong> - HIPAA, GDPR, trade secrets, or anything you can&#x27;t ethically send to third parties</li>
<li><strong>Need predictable costs at scale</strong> - Processing 50K+ documents with 10K+ queries/day makes APIs expensive fast</li>
<li><strong>Require customization</strong> - Domain-specific entity extraction, custom graph schemas, specialized prompts</li>
<li><strong>Want infrastructure control</strong> - Security policies require on-premise or specific cloud configurations</li>
<li><strong>Can invest in setup</strong> - Initial deployment takes 2-4 weeks with proper testing and hardening</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-stick-with-apis-if-you">❌ Stick with APIs if you:<a href="#-stick-with-apis-if-you" class="hash-link" aria-label="Direct link to ❌ Stick with APIs if you:" title="Direct link to ❌ Stick with APIs if you:">​</a></h3>
<ul>
<li><strong>Need fastest time to market</strong> - Can&#x27;t wait 2-4 weeks for infrastructure setup</li>
<li><strong>Have limited DevOps resources</strong> - No one on staff comfortable managing databases and GPU inference</li>
<li><strong>Process non-sensitive data</strong> - Public information, marketing content, open-source docs</li>
<li><strong>Prefer variable opex over fixed capex</strong> - Want to pay per use, not maintain infrastructure</li>
<li><strong>Require vendor support SLAs</strong> - Need 24/7 support with guaranteed response times</li>
</ul>
<p>For most enterprises with &gt;10K documents and serious data governance requirements, self-hosted makes sense. For startups prototyping or teams processing public data, APIs are faster and simpler.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-enhancements-im-exploring">Future Enhancements I&#x27;m Exploring<a href="#future-enhancements-im-exploring" class="hash-link" aria-label="Direct link to Future Enhancements I&#x27;m Exploring" title="Direct link to Future Enhancements I&#x27;m Exploring">​</a></h2>
<p>This is where things get exciting.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-modal-rag">Multi-Modal RAG<a href="#multi-modal-rag" class="hash-link" aria-label="Direct link to Multi-Modal RAG" title="Direct link to Multi-Modal RAG">​</a></h3>
<p>Current limitation: LightRAG processes text only. But most technical documentation includes:</p>
<ul>
<li>Architecture diagrams</li>
<li>Database schemas</li>
<li>Screenshots of UIs</li>
<li>Performance graphs</li>
</ul>
<p>I&#x27;m experimenting with integrating vision models (like LLaVA) to extract information from images before feeding to LightRAG. Early tests show promise for understanding architecture diagrams.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-query-capabilities">Advanced Query Capabilities<a href="#advanced-query-capabilities" class="hash-link" aria-label="Direct link to Advanced Query Capabilities" title="Direct link to Advanced Query Capabilities">​</a></h3>
<p>Right now, queries are natural language with keyword extraction. I want:</p>
<ul>
<li><strong>Natural language to Cypher</strong> - &quot;Show me all services that depend on the authentication API&quot; → translated to Neo4j Cypher query</li>
<li><strong>Temporal queries</strong> - &quot;How has our deployment strategy evolved over the past year?&quot;</li>
<li><strong>Multi-hop reasoning visualization</strong> - See the graph traversal that produced an answer</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="continuous-learning-pipeline">Continuous Learning Pipeline<a href="#continuous-learning-pipeline" class="hash-link" aria-label="Direct link to Continuous Learning Pipeline" title="Direct link to Continuous Learning Pipeline">​</a></h3>
<p>LightRAG doesn&#x27;t learn from user feedback yet. I&#x27;m building:</p>
<ul>
<li>Thumbs up/down on answers to identify weak areas</li>
<li>User corrections of entity relationships</li>
<li>Automated fine-tuning pipeline for Phi-4 on corrected examples</li>
</ul>
<p>The goal: knowledge base quality improves over time based on actual usage.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways">​</a></h2>
<p>After six months of building, deploying, and refining this system, here&#x27;s what matters:</p>
<ol>
<li>
<p><strong>Local SLMs are production-ready</strong> - Phi-4 handles complex RAG tasks that I previously thought required GPT-4. The performance gap is closing fast.</p>
</li>
<li>
<p><strong>Graph RAG outperforms naive RAG</strong> - Multi-hop reasoning and entity relationships produce substantially better answers for complex questions. The difference is dramatic.</p>
</li>
<li>
<p><strong>Cost savings are real</strong> - 30-60% reduction in operating costs compared to API-based approaches. More importantly, costs are predictable and don&#x27;t scale with usage.</p>
</li>
<li>
<p><strong>Control matters more than convenience</strong> - For enterprises with sensitive data, the ability to keep everything in-house is worth the operational complexity.</p>
</li>
<li>
<p><strong>Setup time is the main barrier</strong> - Initial deployment takes 2-4 weeks. But once running, maintenance is minimal (2-4 hours/month).</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-started-today">Get Started Today<a href="#get-started-today" class="hash-link" aria-label="Direct link to Get Started Today" title="Direct link to Get Started Today">​</a></h2>
<p>If you&#x27;re convinced this approach makes sense for your organization, here&#x27;s your next steps:</p>
<ol>
<li>
<p><strong>Start with development deployment</strong> - Prove the concept on a subset of your documents (~1,000) before committing to production infrastructure</p>
</li>
<li>
<p><strong>Measure baseline performance</strong> - Index documents and run representative queries. Benchmark against your current solution (if any).</p>
</li>
<li>
<p><strong>Calculate your economics</strong> - Use your actual document count and query volume to build a cost model. Factor in setup time and maintenance.</p>
</li>
<li>
<p><strong>Plan your production architecture</strong> - Decide on AWS vs on-premise based on your compliance requirements and existing infrastructure.</p>
</li>
<li>
<p><strong>Gradually migrate</strong> - Don&#x27;t try to index everything at once. Start with one domain (e.g., engineering docs) and expand iteratively.</p>
</li>
</ol>
<hr>
<p>Have you experimented with local LLMs for RAG? I&#x27;d love to hear about your experiences—what worked, what didn&#x27;t, and what surprised you.</p>
<p>If you found this helpful:</p>
<ul>
<li>⭐ Star the <a href="https://github.com/HKUDS/LightRAG" target="_blank" rel="noopener noreferrer">LightRAG repository</a></li>
<li>📢 Share this with your engineering team</li>
<li>💬 Drop a comment with your implementation challenges</li>
</ul>
<p>I&#x27;m planning follow-up posts on:</p>
<ul>
<li>Fine-tuning Phi-4 for domain-specific entity extraction</li>
<li>Optimizing Neo4j query performance for large knowledge graphs</li>
<li>Building a Claude Code MCP integration for querying from your editor</li>
</ul>
<p>Which would you find most valuable? Let me know.</p>
<hr>
<p><em>Jon Roosevelt is an AI architect specializing in healthcare and enterprise systems. He&#x27;s helped organizations build production ML systems handling millions of documents and has a particular interest in making powerful AI accessible through self-hosted infrastructure.</em></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a title="Articles about artificial intelligence and machine learning" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/ai">AI</a></li><li class="tag_QGVx"><a title="Large Language Models and their applications" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/llm">LLM</a></li><li class="tag_QGVx"><a title="Retrieval Augmented Generation (RAG) techniques and applications" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/rag">RAG</a></li><li class="tag_QGVx"><a title="Healthcare technology and applications" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/healthcare">Healthcare</a></li><li class="tag_QGVx"><a title="Cloud computing platforms and services" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/cloud">Cloud</a></li><li class="tag_QGVx"><a title="System architecture and design patterns" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/architecture">Architecture</a></li><li class="tag_QGVx"><a title="Data management and analytics content" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tags/data">Data</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/patient-insurance-education-app"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Building Tools to Fix Real Problems: A Patient Insurance Education App</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/building-aoa-agent-lovable-n8n"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Building an AI Analysis Agent in Hours - A No-Code Approach with Lovable and N8N</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-local-slms--graph-rag-matter-now" class="table-of-contents__link toc-highlight">Why Local SLMs + Graph RAG Matter Now</a><ul><li><a href="#the-real-cost-story" class="table-of-contents__link toc-highlight">The Real Cost Story</a></li><li><a href="#data-sovereignty-changes-everything" class="table-of-contents__link toc-highlight">Data Sovereignty Changes Everything</a></li><li><a href="#performance-at-your-pace" class="table-of-contents__link toc-highlight">Performance at Your Pace</a></li></ul></li><li><a href="#architecture-deep-dive" class="table-of-contents__link toc-highlight">Architecture Deep Dive</a><ul><li><a href="#why-four-storage-systems" class="table-of-contents__link toc-highlight">Why Four Storage Systems?</a></li><li><a href="#lightrag-the-secret-sauce" class="table-of-contents__link toc-highlight">LightRAG: The Secret Sauce</a></li></ul></li><li><a href="#two-deployment-paths" class="table-of-contents__link toc-highlight">Two Deployment Paths</a><ul><li><a href="#path-1-local-linux-machine-budget-friendly" class="table-of-contents__link toc-highlight">Path 1: Local Linux Machine (Budget-Friendly)</a></li><li><a href="#path-2-aws-cloud-native-architecture" class="table-of-contents__link toc-highlight">Path 2: AWS Cloud-Native Architecture</a></li></ul></li><li><a href="#what-i-learned-the-hard-way" class="table-of-contents__link toc-highlight">What I Learned (The Hard Way)</a><ul><li><a href="#lesson-1-git-history-and-upstream-syncing" class="table-of-contents__link toc-highlight">Lesson 1: Git History and Upstream Syncing</a></li><li><a href="#lesson-2-docker-service-dependencies-matter" class="table-of-contents__link toc-highlight">Lesson 2: Docker Service Dependencies Matter</a></li><li><a href="#lesson-3-phi-4-context-window-configuration" class="table-of-contents__link toc-highlight">Lesson 3: Phi-4 Context Window Configuration</a></li><li><a href="#lesson-4-document-processing-needs-robust-retry-logic" class="table-of-contents__link toc-highlight">Lesson 4: Document Processing Needs Robust Retry Logic</a></li><li><a href="#lesson-5-memory-tuning-is-non-negotiable" class="table-of-contents__link toc-highlight">Lesson 5: Memory Tuning Is Non-Negotiable</a></li></ul></li><li><a href="#getting-started-30-minute-quick-start" class="table-of-contents__link toc-highlight">Getting Started: 30-Minute Quick Start</a><ul><li><a href="#step-1-prerequisites-check" class="table-of-contents__link toc-highlight">Step 1: Prerequisites Check</a></li><li><a href="#step-2-clone-and-configure" class="table-of-contents__link toc-highlight">Step 2: Clone and Configure</a></li><li><a href="#step-3-set-up-phi-4-with-ollama" class="table-of-contents__link toc-highlight">Step 3: Set Up Phi-4 with Ollama</a></li><li><a href="#step-4-configure-environment-variables" class="table-of-contents__link toc-highlight">Step 4: Configure Environment Variables</a></li><li><a href="#step-5-launch-the-stack" class="table-of-contents__link toc-highlight">Step 5: Launch the Stack</a></li><li><a href="#step-6-verify-deployment" class="table-of-contents__link toc-highlight">Step 6: Verify Deployment</a></li></ul></li><li><a href="#real-world-use-case-indexing-technical-documentation" class="table-of-contents__link toc-highlight">Real-World Use Case: Indexing Technical Documentation</a><ul><li><a href="#step-1-prepare-your-documents" class="table-of-contents__link toc-highlight">Step 1: Prepare Your Documents</a></li><li><a href="#step-2-bulk-insert-via-api" class="table-of-contents__link toc-highlight">Step 2: Bulk Insert via API</a></li><li><a href="#step-3-monitor-processing" class="table-of-contents__link toc-highlight">Step 3: Monitor Processing</a></li><li><a href="#step-4-query-your-knowledge-base" class="table-of-contents__link toc-highlight">Step 4: Query Your Knowledge Base</a></li><li><a href="#results-in-my-testing" class="table-of-contents__link toc-highlight">Results in My Testing</a></li></ul></li><li><a href="#production-considerations" class="table-of-contents__link toc-highlight">Production Considerations</a><ul><li><a href="#security-hardening" class="table-of-contents__link toc-highlight">Security Hardening</a></li><li><a href="#monitoring-and-observability" class="table-of-contents__link toc-highlight">Monitoring and Observability</a></li><li><a href="#backup-and-disaster-recovery" class="table-of-contents__link toc-highlight">Backup and Disaster Recovery</a></li><li><a href="#scaling-strategies" class="table-of-contents__link toc-highlight">Scaling Strategies</a></li></ul></li><li><a href="#roi-and-business-case" class="table-of-contents__link toc-highlight">ROI and Business Case</a><ul><li><a href="#12-month-cost-comparison" class="table-of-contents__link toc-highlight">12-Month Cost Comparison</a></li><li><a href="#beyond-cost-strategic-value" class="table-of-contents__link toc-highlight">Beyond Cost: Strategic Value</a></li></ul></li><li><a href="#when-should-you-choose-this-approach" class="table-of-contents__link toc-highlight">When Should You Choose This Approach?</a><ul><li><a href="#-choose-local--lightrag-if-you" class="table-of-contents__link toc-highlight">✅ Choose Local + LightRAG if you:</a></li><li><a href="#-stick-with-apis-if-you" class="table-of-contents__link toc-highlight">❌ Stick with APIs if you:</a></li></ul></li><li><a href="#future-enhancements-im-exploring" class="table-of-contents__link toc-highlight">Future Enhancements I&#39;m Exploring</a><ul><li><a href="#multi-modal-rag" class="table-of-contents__link toc-highlight">Multi-Modal RAG</a></li><li><a href="#advanced-query-capabilities" class="table-of-contents__link toc-highlight">Advanced Query Capabilities</a></li><li><a href="#continuous-learning-pipeline" class="table-of-contents__link toc-highlight">Continuous Learning Pipeline</a></li></ul></li><li><a href="#key-takeaways" class="table-of-contents__link toc-highlight">Key Takeaways</a></li><li><a href="#get-started-today" class="table-of-contents__link toc-highlight">Get Started Today</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/jonroosevelt/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Jon Roosevelt, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>